import{u as S,r as t,j as s,s as x}from"./index-UkIvKgPy.js";function P(){const u=S(),[a,f]=t.useState(""),[l,j]=t.useState(""),[m,N]=t.useState(!1),[n,p]=t.useState(!1),[h,g]=t.useState(""),[b,w]=t.useState(!1),v=t.useMemo(()=>a.trim().length>=8&&a.trim().length<=64,[a]),y=t.useMemo(()=>/[A-Za-z]/.test(a)&&/\d/.test(a),[a]),i=v&&y,d=t.useMemo(()=>l===a&&l.length>0,[l,a]),c=e=>{window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")),window.scrollTo({top:0,behavior:"smooth"})};return t.useEffect(()=>{let e=!0;return(async()=>{try{const{data:r}=await x.auth.getSession();if(!e)return;w(!!r?.session)}catch{if(!e)return;w(!1)}})(),()=>{e=!1}},[]),s.jsxs("div",{className:"loginShell",children:[s.jsxs("div",{className:"loginShell__left","aria-hidden":"true",children:[s.jsxs("div",{className:"loginHero",children:[s.jsxs("h1",{className:"loginHero__headline",children:["Set a new ",s.jsx("span",{className:"loginHero__highlight",children:"password"})]}),s.jsx("p",{className:"loginSubtitle",style:{marginTop:16,maxWidth:420},children:"Use a strong password you don’t use elsewhere."})]}),s.jsx("div",{className:"loginArt"})]}),s.jsx("div",{className:"loginShell__right",children:s.jsxs("div",{className:"loginPanel",children:[s.jsx("div",{className:"loginBrand",children:"ML FORGE"}),s.jsx("h1",{className:"loginTitle",children:"Reset password"}),s.jsx("p",{className:"loginSubtitle",children:"Choose your new password below."}),b?s.jsxs("form",{className:"loginForm",onSubmit:async e=>{if(e.preventDefault(),N(!0),g(""),!(!i||!d||n))try{p(!0);const{error:o}=await x.auth.updateUser({password:a});if(o)throw o;u.success("Password updated"),c("/login")}catch(o){const r=o?.message||"Unable to update password. Please try again.";g(r),u.error(r)}finally{p(!1)}},children:[s.jsxs("label",{className:"loginLabel",children:["New password",s.jsx("input",{className:"loginInput",type:"password",placeholder:"Create a strong password",autoComplete:"new-password",value:a,onChange:e=>f(e.target.value),disabled:n})]}),m&&!i&&s.jsx("div",{className:"loginHint",children:"Password must be 8–64 characters and include at least 1 letter and 1 number."}),s.jsxs("label",{className:"loginLabel",children:["Confirm new password",s.jsx("input",{className:"loginInput",type:"password",placeholder:"Repeat new password",autoComplete:"new-password",value:l,onChange:e=>j(e.target.value),disabled:n})]}),m&&!d&&s.jsx("div",{className:"loginHint",children:"Passwords must match."}),h&&s.jsx("div",{className:"loginHint",children:h}),s.jsx("button",{className:"button button--primary loginSubmit",type:"submit",disabled:!i||!d||n,children:n?"Updating…":"Update password"})]}):s.jsxs("div",{className:"loginHint",style:{marginTop:12},children:["This reset link may be expired or already used. Please request a new link.",s.jsx("div",{style:{marginTop:12},children:s.jsx("a",{className:"loginLink",href:"/forgot-password",onClick:e=>{e.preventDefault(),c("/forgot-password")},children:"Request a new reset link"})})]}),s.jsxs("div",{className:"loginRow loginRow--bottom",children:[s.jsx("span",{className:"loginMuted",children:"Back to"}),s.jsx("a",{className:"loginLink",href:"/login",onClick:e=>{e.preventDefault(),c("/login")},children:"login"})]})]})})]})}export{P as default};
