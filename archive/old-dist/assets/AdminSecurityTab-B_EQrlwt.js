import{j as e,L as o}from"./index-UkIvKgPy.js";import{U as d,V as l,X as n,W as r,Y as a,Z as m}from"./card-kPhyKK4t.js";function D({inboxMessages:c,inboxLoading:N,auditLog:h,securityActiveOnly:f,setSecurityActiveOnly:b,securityNewEmail:v,setSecurityNewEmail:y,securityNewIp:_,setSecurityNewIp:k,securityNewUserId:w,setSecurityNewUserId:S,securityNewReason:C,setSecurityNewReason:A,securityLoading:x,securityBlocklist:u,securityEvents:j,addBlocklistEntry:T,deactivateBlocklistEntry:R,formatDateTime:p,getUserEmailById:g,navigateToUserDetail:z}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(d,{children:[e.jsxs(l,{className:"pb-2",children:[e.jsx(n,{children:"Open inbox"}),e.jsx(r,{className:"text-2xl",children:(c||[]).filter(s=>["new","investigating"].includes(String(s?.status||"new"))).length})]}),e.jsx(a,{className:"text-xs text-muted-foreground",children:"new + investigating"})]}),e.jsxs(d,{children:[e.jsxs(l,{className:"pb-2",children:[e.jsx(n,{children:"Unassigned inbox"}),e.jsx(r,{className:"text-2xl",children:(c||[]).filter(s=>!s?.assigned_to&&["new","investigating"].includes(String(s?.status||"new"))).length})]}),e.jsx(a,{className:"text-xs text-muted-foreground",children:"needs triage"})]}),e.jsxs(d,{children:[e.jsxs(l,{className:"pb-2",children:[e.jsx(n,{children:"Recent admin actions"}),e.jsx(r,{className:"text-2xl",children:(h||[]).length})]}),e.jsx(a,{className:"text-xs text-muted-foreground",children:"last 50"})]}),e.jsxs(d,{children:[e.jsxs(l,{className:"pb-2",children:[e.jsx(n,{children:"Resends queued"}),e.jsx(r,{className:"text-2xl",children:(c||[]).filter(s=>(s?.resend_count||0)>0&&["new","investigating"].includes(String(s?.status||"new"))).length})]}),e.jsx(a,{className:"text-xs text-muted-foreground",children:"potential abuse / stuck deliveries"})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(d,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"High-risk admin actions"}),e.jsx(n,{children:"Quick review of potentially sensitive operations"})]}),e.jsx(a,{children:(()=>{const s=(h||[]).filter(t=>{const i=String(t?.action_type||"").toLowerCase();return i.includes("token")||i.includes("license")||i.includes("assign")||i.includes("deactiv")||i.includes("disable")||i.includes("role")||i.includes("admin")});return s.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No high-risk actions found in the last 50."}):e.jsx("div",{className:"overflow-auto rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/30 text-xs text-muted-foreground",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Admin"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Action"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Target"})]})}),e.jsx("tbody",{children:s.slice(0,15).map(t=>e.jsxs("tr",{className:"border-b last:border-b-0",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:p(t.created_at)}),e.jsx("td",{className:"px-3 py-2",children:g(t.admin_user_id)||"N/A"}),e.jsx("td",{className:"px-3 py-2",children:String(t.action_type||"").replace(/_/g," ")}),e.jsx("td",{className:"px-3 py-2",children:g(t.target_user_id)||"—"})]},String(t.action_id)))})]})})})()})]}),e.jsxs(d,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Inbox anomalies"}),e.jsx(n,{children:"Requests that may indicate abuse or delivery problems"})]}),e.jsx(a,{children:N?e.jsx("div",{className:"py-10 text-center",children:e.jsx(o,{})}):(()=>{const s=(c||[]).filter(t=>{const i=String(t?.status||"new"),q=Number(t?.resend_count||0);return["new","investigating"].includes(i)&&(q>=2||!t?.linked_user_id)});return s.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No anomalies detected in current inbox results."}):e.jsx("div",{className:"divide-y rounded-md border",children:s.slice(0,12).map(t=>e.jsxs("div",{className:"flex items-start justify-between gap-3 px-3 py-3 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:t.email||"—"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["status: ",String(t.status||"new")," · tag: ",String(t.tag||"—")," · resends: ",t.resend_count||0]})]}),e.jsx("div",{className:"flex shrink-0 gap-2",children:t.linked_user_id&&e.jsx(m,{variant:"outline",size:"sm",onClick:()=>z(t.linked_user_id),children:"User"})})]},String(t.request_id)))})})()})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(d,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Blocklist"}),e.jsx(n,{children:"Block email, IP, or user_id (super only)"})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>b(s=>!s),children:f?"Showing active":"Showing all"})]})}),e.jsxs(a,{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsx("input",{type:"text",value:v,onChange:s=>y(s.target.value),placeholder:"Email (optional)",className:"h-9 rounded-md border bg-background px-3 text-sm"}),e.jsx("input",{type:"text",value:_,onChange:s=>k(s.target.value),placeholder:"IP address (optional)",className:"h-9 rounded-md border bg-background px-3 text-sm"})]}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsx("input",{type:"text",value:w,onChange:s=>S(s.target.value),placeholder:"User ID (optional)",className:"h-9 rounded-md border bg-background px-3 text-sm"}),e.jsx("input",{type:"text",value:C,onChange:s=>A(s.target.value),placeholder:"Reason",className:"h-9 rounded-md border bg-background px-3 text-sm"})]}),e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(m,{variant:"outline",size:"sm",onClick:T,disabled:x,children:"Add"})}),x?e.jsx("div",{className:"py-6 text-center",children:e.jsx(o,{})}):u.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No blocklist entries."}):e.jsx("div",{className:"overflow-auto rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/30 text-xs text-muted-foreground",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Target"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Reason"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Active"}),e.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Action"})]})}),e.jsx("tbody",{children:u.slice(0,30).map(s=>{const t=s.email||s.ip_address||s.user_id||"—";return e.jsxs("tr",{className:"border-b last:border-b-0",children:[e.jsx("td",{className:"px-3 py-2",children:String(t)}),e.jsx("td",{className:"px-3 py-2 max-w-[360px] truncate",children:s.reason||"—"}),e.jsx("td",{className:"px-3 py-2",children:s.is_active?"yes":"no"}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx(m,{variant:"outline",size:"sm",disabled:!s.is_active||x,onClick:()=>R(s.block_id),children:"Deactivate"})})]},String(s.block_id))})})]})})]})]}),e.jsxs(d,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Security events"}),e.jsx(n,{children:"Latest admin security events"})]}),e.jsx(a,{children:x?e.jsx("div",{className:"py-6 text-center",children:e.jsx(o,{})}):j.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No events."}):e.jsx("div",{className:"overflow-auto rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/30 text-xs text-muted-foreground",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Time"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Type"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Severity"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Target"})]})}),e.jsx("tbody",{children:j.slice(0,30).map(s=>{const t=s.email||s.ip_address||s.user_id||"—";return e.jsxs("tr",{className:"border-b last:border-b-0",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:p(s.created_at)}),e.jsx("td",{className:"px-3 py-2",children:s.event_type||"—"}),e.jsx("td",{className:"px-3 py-2",children:s.severity||"info"}),e.jsx("td",{className:"px-3 py-2",children:String(t)})]},String(s.event_id))})})]})})})]})]})]})}export{D as default};
