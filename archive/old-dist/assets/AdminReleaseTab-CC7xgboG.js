import{j as e,L as j}from"./index-UkIvKgPy.js";import{U as i,V as d,X as a,W as c,Y as o,Z as g}from"./card-kPhyKK4t.js";function f({diagnosticsEvents:x,diagnosticsLoading:m,featureFlags:h,handleToggleFeature:p}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(i,{children:[e.jsxs(d,{className:"pb-2",children:[e.jsx(a,{children:"Events loaded"}),e.jsx(c,{className:"text-2xl",children:(x||[]).length})]}),e.jsx(o,{className:"text-xs text-muted-foreground",children:"latest 200 diagnostics events"})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"pb-2",children:[e.jsx(a,{children:"Unique app versions"}),e.jsx(c,{className:"text-2xl",children:Array.from(new Set((x||[]).map(n=>String(n?.app_version||"unknown")))).length})]}),e.jsx(o,{className:"text-xs text-muted-foreground",children:"observed in recent events"})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"pb-2",children:[e.jsx(a,{children:"Crash events"}),e.jsx(c,{className:"text-2xl",children:(x||[]).filter(n=>String(n?.event_type||"")==="crash").length})]}),e.jsx(o,{className:"text-xs text-muted-foreground",children:"proxy regression signal"})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"pb-2",children:[e.jsx(a,{children:"Rollout flags"}),e.jsx(c,{className:"text-2xl",children:(h||[]).filter(n=>{const s=String(n?.flag_key||"").toLowerCase();return String(n?.category||"").toLowerCase().includes("rollout")||s.includes("rollout")||s.includes("release")||s.includes("version")}).length})]}),e.jsx(o,{className:"text-xs text-muted-foreground",children:"feature flag driven"})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Version distribution"}),e.jsx(a,{children:"Top app versions by event volume (latest 200)"})]}),e.jsx(o,{children:m?e.jsx("div",{className:"py-10 text-center",children:e.jsx(j,{})}):(()=>{const n=(x||[]).reduce((t,r)=>{const l=String(r?.app_version||"unknown");return t[l]=(t[l]||0)+1,t},{}),s=Object.entries(n).sort((t,r)=>r[1]-t[1]).slice(0,12);return s.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No events available."}):e.jsx("div",{className:"divide-y rounded-md border",children:s.map(([t,r])=>e.jsxs("div",{className:"flex items-center justify-between gap-3 px-3 py-3 text-sm",children:[e.jsx("div",{className:"font-medium",children:t}),e.jsx("div",{className:"text-muted-foreground",children:r})]},t))})})()})]}),e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Rollout controls"}),e.jsx(a,{children:"Commonly used release toggles (feature flags)"})]}),e.jsx(o,{className:"space-y-3",children:(()=>{const n=(h||[]).filter(s=>{const t=String(s?.flag_key||"").toLowerCase();return String(s?.category||"").toLowerCase().includes("rollout")||t.includes("rollout")||t.includes("release")||t.includes("version")}).slice(0,12);return n.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No rollout-related flags found."}):e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-md border px-3 py-2 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:s.flag_key}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:String(s.category||"").replace(/_/g," ")})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>p(s.flag_key,s.enabled),children:s.enabled?"Enabled":"Disabled"})]},String(s.flag_key)))})})()})]})]}),e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"Crash distribution by version"}),e.jsx(a,{children:"Quick regression signal: crashes grouped by app_version"})]}),e.jsx(o,{children:m?e.jsx("div",{className:"py-10 text-center",children:e.jsx(j,{})}):(()=>{const s=(x||[]).filter(r=>String(r?.event_type||"")==="crash").reduce((r,l)=>{const u=String(l?.app_version||"unknown");return r[u]=(r[u]||0)+1,r},{}),t=Object.entries(s).sort((r,l)=>l[1]-r[1]).slice(0,12);return t.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No crash events in the current window."}):e.jsx("div",{className:"overflow-auto rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/30 text-xs text-muted-foreground",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Version"}),e.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Crashes"})]})}),e.jsx("tbody",{children:t.map(([r,l])=>e.jsxs("tr",{className:"border-b last:border-b-0",children:[e.jsx("td",{className:"px-3 py-2",children:r}),e.jsx("td",{className:"px-3 py-2",children:l})]},r))})]})})})()})]})]})}export{f as default};
