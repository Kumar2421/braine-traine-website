import{u as q,r as n,j as e,L as B}from"./index-UkIvKgPy.js";import{e as re,f as j,a as ne,g as le,b as de,c as oe,r as ce,d as he}from"./razorpayApi-D6uxyQ4R.js";import{e as ue,u as pe,f as me,c as xe,b as _e,h as ge,i as g,a as c,g as I,d as je}from"./usageLimits-B5DWR5Ov.js";import{U as ve}from"./UsageChart-DDzAler7.js";import{L as G,U as ye}from"./UpgradePrompt-BYfbfL5M.js";function be({isOpen:v,onClose:p,currentSubscription:l,onSuccess:A}){const y=q(),[r,L]=n.useState([]),[d,H]=n.useState(null),[f,k]=n.useState(!1),[C,P]=n.useState(!1),[o,N]=n.useState(null),[_,D]=n.useState(null),[m,$]=n.useState(!1);n.useEffect(()=>{v&&E()},[v]);const E=async()=>{try{const{data:i}=await re();i&&L(i.filter(u=>u.plan_key!=="free"))}catch(i){console.error("Error loading plans:",i)}},U=async i=>{H(i),P(!0);try{const u=await ue(l.subscription_id,i.plan_key);u.success?(N(u.breakdown),D(u.breakdown.isUpgrade?"upgrade":"downgrade")):y.error(u.error||"Failed to calculate proration")}catch(u){console.error("Error calculating proration:",u),y.error("Failed to calculate proration")}finally{P(!1)}},R=async()=>{if(!(!d||!o)){k(!0);try{let i;_==="upgrade"?i=await pe(l.subscription_id,d.plan_key):i=await me(l.subscription_id,d.plan_key,m),i.success?(y.success(`Subscription ${_==="upgrade"?"upgraded":"downgraded"} successfully`),A?.(),p()):y.error(i.error||`Failed to ${_} subscription`)}catch(i){console.error(`Error ${_}ing subscription:`,i),y.error(`Failed to ${_} subscription`)}finally{k(!1)}}};if(!v)return null;const w=r.find(i=>i.plan_key===l?.plan_type);return e.jsx("div",{className:"modal-overlay",onClick:p,children:e.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Change Subscription Plan"}),e.jsx("button",{className:"modal-close",onClick:p,children:"×"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"plan-comparison",children:[e.jsxs("div",{className:"plan-card plan-card--current",children:[e.jsx("h3",{children:"Current Plan"}),e.jsx("div",{className:"plan-name",children:w?.plan_name||l?.plan_type}),e.jsxs("div",{className:"plan-price",children:[w&&j(l?.billing_interval==="yearly"?w.price_yearly:w.price_monthly),"/",l?.billing_interval==="yearly"?"year":"month"]})]}),e.jsx("div",{className:"plan-arrow",children:"→"}),e.jsxs("div",{className:"plan-card plan-card--selected",children:[e.jsx("h3",{children:d?"New Plan":"Select Plan"}),d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"plan-name",children:d.plan_name}),e.jsxs("div",{className:"plan-price",children:[j(l?.billing_interval==="yearly"?d.price_yearly:d.price_monthly),"/",l?.billing_interval==="yearly"?"year":"month"]})]}):e.jsx("div",{className:"plan-placeholder",children:"Select a plan below"})]})]}),e.jsxs("div",{className:"plan-selection",children:[e.jsx("h3",{children:"Available Plans"}),e.jsx("div",{className:"plan-grid",children:r.map(i=>{const u=i.plan_key===l?.plan_type,a=d?.plan_key===i.plan_key;return e.jsxs("div",{className:`plan-option ${u?"plan-option--current":""} ${a?"plan-option--selected":""}`,onClick:()=>!u&&U(i),children:[e.jsx("div",{className:"plan-option__name",children:i.plan_name}),e.jsxs("div",{className:"plan-option__price",children:[j(l?.billing_interval==="yearly"?i.price_yearly:i.price_monthly),"/",l?.billing_interval==="yearly"?"year":"month"]}),u&&e.jsx("div",{className:"plan-option__badge",children:"Current"}),a&&e.jsx("div",{className:"plan-option__badge plan-option__badge--selected",children:"Selected"})]},i.plan_id)})})]}),C&&e.jsxs("div",{className:"proration-loading",children:[e.jsx(B,{size:"small"}),e.jsx("span",{children:"Calculating proration..."})]}),o&&d&&e.jsxs("div",{className:"proration-preview",children:[e.jsx("h3",{children:"Billing Preview"}),e.jsxs("div",{className:"proration-breakdown",children:[e.jsxs("div",{className:"proration-row",children:[e.jsx("span",{children:"Days remaining in current period:"}),e.jsxs("span",{children:[o.daysRemaining," days"]})]}),e.jsxs("div",{className:"proration-row",children:[e.jsx("span",{children:"Unused amount (credit):"}),e.jsxs("span",{children:["-",j(o.unusedAmount)]})]}),e.jsxs("div",{className:"proration-row",children:[e.jsx("span",{children:"New plan cost:"}),e.jsx("span",{children:j(o.newPrice)})]}),e.jsxs("div",{className:"proration-row proration-row--total",children:[e.jsx("span",{children:"Amount due now:"}),e.jsx("span",{children:j(o.proratedAmount)})]})]}),_==="downgrade"&&e.jsx("div",{className:"downgrade-options",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:m,onChange:i=>$(i.target.checked)}),e.jsx("span",{children:"Downgrade immediately (otherwise at period end)"})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"button button--outline",onClick:p,disabled:f,children:"Cancel"}),e.jsx("button",{className:"button button--primary",onClick:R,disabled:f||!d||!o||C,children:f?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"small"}),"Processing..."]}):`Confirm ${_==="upgrade"?"Upgrade":"Downgrade"}`})]})]})})}function De({session:v,navigate:p}){const l=q(),[A,y]=n.useState(!0),[r,L]=n.useState(null),[d,H]=n.useState(null),[f,k]=n.useState([]),[C,P]=n.useState([]),[o,N]=n.useState("overview"),[_,D]=n.useState(!1),[m,$]=n.useState(null),[E,U]=n.useState(!1),[R,w]=n.useState([]),[i,u]=n.useState(null),[a,J]=n.useState(null);n.useEffect(()=>{T()},[v]),n.useEffect(()=>{(async()=>{if(v?.user?.id)try{const t=await je(v.user.id);t.data&&J(t.data)}catch(t){console.error("Error loading usage limits:",t)}})()},[v]);const T=async()=>{y(!0);try{const[s,t,x,b,h]=await Promise.all([ne(),le(),de(20),oe(),xe()]);s.data&&(L(s.data),K(s.data.subscription_id),Q(s.data.subscription_id)),t.data&&H(t.data),x.data&&k(x.data),b.data&&P(b.data),h.data&&u(h.data)}catch(s){console.error("Error loading subscription data:",s),l.error("Failed to load subscription data")}finally{y(!1)}},K=async s=>{if(s){U(!0);try{const t=await _e(s);if(t.data){const x=X(t.data);$(x)}}catch(t){console.error("Error loading usage data:",t)}finally{U(!1)}}},Q=async s=>{if(s)try{const t=await ge(s);t.data&&w(t.data)}catch(t){console.error("Error loading change history:",t)}},X=s=>{const t=[],x=new Date;for(let b=29;b>=0;b--){const h=new Date(x);h.setDate(h.getDate()-b);const F=h.toISOString().split("T")[0],z=(s.gpuUsage?.filter(W=>new Date(W.usage_start).toISOString().split("T")[0]===F)||[]).reduce((W,O)=>W+parseFloat(O.hours_used||0),0);t.push({date:F,label:h.toLocaleDateString("en-US",{month:"short",day:"numeric"}),value:z})}return t},Z=()=>{if(!r)return[];const s=[],t=new Date(r.current_period_start),x=new Date(r.current_period_end),b=new Date,h=new Date(t);for(;h<=x;){const F=h.getTime()===x.getTime(),V=i&&new Date(i.trial_end).toDateString()===h.toDateString(),z=h<b;s.push({date:new Date(h),isBillingDay:F,isTrialEnd:V,isPast:z}),h.setDate(h.getDate()+1)}return s},ee=async s=>{try{const t=f.find(x=>x.billing_id===s);t?.invoice_pdf_url?window.open(t.invoice_pdf_url,"_blank"):t?.hosted_invoice_url?window.open(t.hosted_invoice_url,"_blank"):l.info("Invoice not available yet. Please check back later.")}catch(t){console.error("Error downloading invoice:",t),l.error("Failed to download invoice")}},Y=async()=>{l.info("Subscription management available in your account")},se=async()=>{if(!r||!confirm("Are you sure you want to cancel your subscription? You will continue to have access until the end of your billing period."))return;const t=await he(r.subscription_id);t.success?(l.success("Subscription will be canceled at the end of the billing period"),T()):l.error(t.error||"Failed to cancel subscription")},ae=async()=>{if(!r)return;const s=await ce(r.subscription_id);s.success?(l.success("Subscription resumed successfully"),T()):l.error(s.error||"Failed to resume subscription")},S=s=>{if(!s)return"Never";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid date"}},te=s=>{if(!s)return"Never";try{return new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},M=s=>({free:"Free — Explore",data_pro:"Data Pro — Prepare",train_pro:"Train Pro — Build",deploy_pro:"Deploy Pro — Ship",enterprise:"Enterprise"})[s]||s,ie=s=>({active:"dashStatus--active",trialing:"dashStatus--active",past_due:"dashStatus--warning",canceled:"dashStatus--archived",unpaid:"dashStatus--archived",paused:"dashStatus--warning"})[s]||"dashStatus--archived";return A?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"48px"},children:e.jsx(B,{})}):e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"dashHero",children:e.jsxs("div",{className:"container dashHero__inner",children:[e.jsx("p",{className:"dashHero__kicker",children:"Subscription"}),e.jsx("h1",{className:"dashHero__title",children:"Manage Your Subscription"}),e.jsx("p",{className:"dashHero__subtitle",children:"View your current plan, billing history, and payment methods."})]})}),e.jsx("section",{className:"dashSection",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"adminTabs",style:{marginBottom:"32px"},children:[e.jsx("button",{className:`adminTab ${o==="overview"?"adminTab--active":""}`,onClick:()=>N("overview"),children:"Overview"}),e.jsx("button",{className:`adminTab ${o==="usage"?"adminTab--active":""}`,onClick:()=>N("usage"),children:"Usage"}),e.jsx("button",{className:`adminTab ${o==="billing"?"adminTab--active":""}`,onClick:()=>N("billing"),children:"Billing History"}),e.jsx("button",{className:`adminTab ${o==="payment-methods"?"adminTab--active":""}`,onClick:()=>N("payment-methods"),children:"Payment Methods"}),e.jsx("button",{className:`adminTab ${o==="history"?"adminTab--active":""}`,onClick:()=>N("history"),children:"Change History"})]}),o==="overview"&&e.jsxs("div",{className:"dashGrid",children:[e.jsxs("article",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Current Plan"}),e.jsxs("div",{className:"dashRows",children:[e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Plan"}),e.jsx("div",{className:"dashRow__value",children:d?.plan_type?M(d.plan_type):"Free"})]}),e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Status"}),e.jsx("div",{className:"dashRow__value",children:r?e.jsx("span",{className:`dashStatus ${ie(r.status)}`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1).replace("_"," ")}):e.jsx("span",{className:"dashStatus dashStatus--active",children:"Active (Free)"})})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Current Period"}),e.jsxs("div",{className:"dashRow__value",children:[S(r.current_period_start)," -"," ",S(r.current_period_end)]})]}),r.cancel_at_period_end&&e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Cancellation"}),e.jsxs("div",{className:"dashRow__value",style:{color:"rgba(239, 68, 68, 0.9)"},children:["Will cancel on ",S(r.current_period_end)]})]})]}),d?.license_expires_at&&e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"License Expires"}),e.jsx("div",{className:"dashRow__value",children:S(d.license_expires_at)})]})]}),e.jsx("div",{className:"dashActions",children:r?e.jsx(e.Fragment,{children:r.cancel_at_period_end?e.jsx("button",{className:"button button--primary",onClick:ae,children:"Resume Subscription"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"button button--primary",onClick:()=>D(!0),children:"Change Plan"}),e.jsx("button",{className:"button button--outline",onClick:se,children:"Cancel Subscription"}),e.jsx("a",{className:"button button--outline",href:"https://dashboard.razorpay.com",target:"_blank",rel:"noopener noreferrer",children:"View in Razorpay"})]})}):e.jsx("a",{className:"button button--primary",href:"/pricing",onClick:s=>{s.preventDefault(),p("/pricing")},children:"Compare plans"})})]}),e.jsxs("article",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Usage Summary"}),e.jsxs("div",{className:"dashRows",children:[e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Total Payments"}),e.jsx("div",{className:"dashRow__value",children:d?.total_payments||0})]}),e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Total Paid"}),e.jsx("div",{className:"dashRow__value",children:d?.total_paid_amount?j(d.total_paid_amount):"₹0.00"})]}),m&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"GPU Usage (30 days)"}),e.jsxs("div",{className:"dashRow__value",children:[m.reduce((s,t)=>s+t.value,0).toFixed(2)," hours"]})]})})]}),a&&e.jsxs("div",{style:{marginTop:"24px",paddingTop:"24px",borderTop:"1px solid var(--dr-border-weak)"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px"},children:"Current Usage Limits"}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"Projects"}),e.jsxs("span",{style:{fontSize:"14px",color:"var(--dr-muted)"},children:[a.usage.projects_count||0," / ",a.limits.max_projects===-1?"∞":a.limits.max_projects]})]}),e.jsx("div",{style:{width:"100%",height:"6px",backgroundColor:"var(--dr-border-weak)",borderRadius:"3px",overflow:"hidden",marginBottom:"4px"},children:e.jsx("div",{style:{width:`${I(a.usage.projects_count||0,a.limits.max_projects)}%`,height:"100%",backgroundColor:c(a.usage.projects_count||0,a.limits.max_projects)?"#ef4444":g(a.usage.projects_count||0,a.limits.max_projects)?"#f59e0b":"#14b8a6",transition:"width 0.3s ease"}})}),e.jsx(G,{current:a.usage.projects_count||0,limit:a.limits.max_projects,label:"projects",isSoftLimit:g(a.usage.projects_count||0,a.limits.max_projects),isHardLimit:c(a.usage.projects_count||0,a.limits.max_projects),onUpgrade:()=>p("/pricing"),showUpgradeButton:!1})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"Exports"}),e.jsxs("span",{style:{fontSize:"14px",color:"var(--dr-muted)"},children:[a.usage.exports_count||0," / ",a.limits.max_exports_per_month===-1?"∞":a.limits.max_exports_per_month]})]}),e.jsx("div",{style:{width:"100%",height:"6px",backgroundColor:"var(--dr-border-weak)",borderRadius:"3px",overflow:"hidden",marginBottom:"4px"},children:e.jsx("div",{style:{width:`${I(a.usage.exports_count||0,a.limits.max_exports_per_month)}%`,height:"100%",backgroundColor:c(a.usage.exports_count||0,a.limits.max_exports_per_month)?"#ef4444":g(a.usage.exports_count||0,a.limits.max_exports_per_month)?"#f59e0b":"#14b8a6",transition:"width 0.3s ease"}})}),e.jsx(G,{current:a.usage.exports_count||0,limit:a.limits.max_exports_per_month,label:"exports",unit:" per month",isSoftLimit:g(a.usage.exports_count||0,a.limits.max_exports_per_month),isHardLimit:c(a.usage.exports_count||0,a.limits.max_exports_per_month),onUpgrade:()=>p("/pricing"),showUpgradeButton:!1})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:"GPU Hours"}),e.jsxs("span",{style:{fontSize:"14px",color:"var(--dr-muted)"},children:[parseFloat(a.usage.gpu_hours_used?.toString()||"0").toFixed(1)," / ",a.limits.max_gpu_hours_per_month===-1?"∞":a.limits.max_gpu_hours_per_month]})]}),e.jsx("div",{style:{width:"100%",height:"6px",backgroundColor:"var(--dr-border-weak)",borderRadius:"3px",overflow:"hidden",marginBottom:"4px"},children:e.jsx("div",{style:{width:`${I(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)}%`,height:"100%",backgroundColor:c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)?"#ef4444":g(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)?"#f59e0b":"#14b8a6",transition:"width 0.3s ease"}})}),e.jsx(G,{current:parseFloat(a.usage.gpu_hours_used?.toString()||"0"),limit:a.limits.max_gpu_hours_per_month,label:"GPU hours",unit:" hours",isSoftLimit:g(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month),isHardLimit:c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month),onUpgrade:()=>p("/pricing"),showUpgradeButton:!1})]}),(g(a.usage.projects_count||0,a.limits.max_projects)||g(a.usage.exports_count||0,a.limits.max_exports_per_month)||g(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)||c(a.usage.projects_count||0,a.limits.max_projects)||c(a.usage.exports_count||0,a.limits.max_exports_per_month)||c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month))&&e.jsx(ye,{title:[c(a.usage.projects_count||0,a.limits.max_projects),c(a.usage.exports_count||0,a.limits.max_exports_per_month),c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)].some(Boolean)?"Usage Limit Reached":"Approaching Usage Limits",message:[c(a.usage.projects_count||0,a.limits.max_projects),c(a.usage.exports_count||0,a.limits.max_exports_per_month),c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)].some(Boolean)?"You've reached one or more usage limits. Choose a plan with higher limits to continue.":"You're approaching your usage limits. Compare plans if you want higher limits.",variant:[c(a.usage.projects_count||0,a.limits.max_projects),c(a.usage.exports_count||0,a.limits.max_exports_per_month),c(parseFloat(a.usage.gpu_hours_used?.toString()||"0"),a.limits.max_gpu_hours_per_month)].some(Boolean)?"error":"warning",onUpgrade:()=>p("/pricing")})]})]}),i&&e.jsxs("article",{className:"dashCard",style:{border:"2px solid #fbbf24",background:"#fef3c7"},children:[e.jsx("h2",{className:"dashCard__title",children:"Trial Period"}),e.jsxs("div",{className:"dashRows",children:[e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Trial End Date"}),e.jsx("div",{className:"dashRow__value",children:S(i.trial_end)})]}),e.jsxs("div",{className:"dashRow",children:[e.jsx("div",{className:"dashRow__label",children:"Days Remaining"}),e.jsxs("div",{className:"dashRow__value",children:[Math.ceil((new Date(i.trial_end)-new Date)/(1e3*60*60*24))," days"]})]})]}),e.jsx("div",{className:"dashActions",children:e.jsx("a",{className:"button button--primary",href:"/pricing",onClick:s=>{s.preventDefault(),p("/pricing")},children:"Choose a plan"})})]}),r&&e.jsxs("article",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Billing Calendar"}),e.jsx("div",{className:"billing-calendar",children:Z().map((s,t)=>e.jsx("div",{className:`calendar-day ${s.isBillingDay?"calendar-day--billing":""} ${s.isTrialEnd?"calendar-day--trial":""} ${s.isPast?"calendar-day--past":""}`,title:s.isBillingDay?"Billing Date":s.isTrialEnd?"Trial Ends":s.date.toLocaleDateString(),children:s.date.getDate()},t))}),e.jsx("div",{style:{marginTop:"16px",fontSize:"14px",color:"var(--dr-muted)"},children:e.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"16px",height:"16px",background:"#14b8a6",borderRadius:"4px"}}),e.jsx("span",{children:"Billing Date"})]}),i&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"16px",height:"16px",background:"#fbbf24",borderRadius:"4px"}}),e.jsx("span",{children:"Trial End"})]})]})})]})]}),o==="usage"&&e.jsxs("div",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Usage Analytics"}),E?e.jsx("div",{style:{padding:"48px",textAlign:"center"},children:e.jsx(B,{})}):m&&m.length>0?e.jsxs(e.Fragment,{children:[e.jsx(ve,{data:m,type:"line",title:"GPU Usage (Last 30 Days)",height:300}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx("h3",{style:{marginBottom:"16px",fontSize:"18px",fontWeight:"600"},children:"Usage Statistics"}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card__label",children:"Total Hours (30 days)"}),e.jsx("div",{className:"stat-card__value",children:m.reduce((s,t)=>s+t.value,0).toFixed(2)}),e.jsx("div",{className:"stat-card__subtext",children:"GPU hours used"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card__label",children:"Average Daily"}),e.jsx("div",{className:"stat-card__value",children:(m.reduce((s,t)=>s+t.value,0)/30).toFixed(2)}),e.jsx("div",{className:"stat-card__subtext",children:"Hours per day"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-card__label",children:"Peak Usage"}),e.jsx("div",{className:"stat-card__value",children:Math.max(...m.map(s=>s.value)).toFixed(2)}),e.jsx("div",{className:"stat-card__subtext",children:"Highest single day"})]})]})]})]}):e.jsx("div",{className:"dashMuted",style:{padding:"24px",textAlign:"center"},children:"No usage data available yet. Usage will appear here as you use GPU resources."})]}),o==="billing"&&e.jsxs("div",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Billing History"}),f.length===0?e.jsx("div",{className:"dashMuted",style:{padding:"24px",textAlign:"center"},children:"No billing history found."}):e.jsxs("div",{className:"dashTable",children:[e.jsxs("div",{className:"dashTable__head",children:[e.jsx("div",{children:"Date"}),e.jsx("div",{children:"Description"}),e.jsx("div",{children:"Amount"}),e.jsx("div",{children:"Status"}),e.jsx("div",{children:"Invoice"})]}),f.map(s=>e.jsxs("div",{className:"dashTable__row",children:[e.jsx("div",{children:S(s.created_at)}),e.jsx("div",{children:s.description||"Subscription payment"}),e.jsx("div",{children:j(s.amount,s.currency)}),e.jsx("div",{children:e.jsx("span",{className:`dashStatus dashStatus--${s.status==="paid"?"active":"archived"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("div",{children:s.invoice_pdf_url||s.hosted_invoice_url?e.jsx("button",{className:"button button--outline",style:{fontSize:"12px",padding:"4px 8px",height:"auto"},onClick:()=>ee(s.billing_id),children:s.invoice_pdf_url?"Download":"View"}):e.jsx("span",{style:{color:"var(--dr-muted)",fontSize:"14px"},children:"—"})})]},s.billing_id))]})]}),o==="payment-methods"&&e.jsxs("div",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Payment Methods"}),C.length===0?e.jsx("div",{className:"dashMuted",style:{padding:"24px",textAlign:"center"},children:"No payment methods found. Add a payment method through the customer portal."}):e.jsxs("div",{className:"dashTable",children:[e.jsxs("div",{className:"dashTable__head",children:[e.jsx("div",{children:"Type"}),e.jsx("div",{children:"Card"}),e.jsx("div",{children:"Expires"}),e.jsx("div",{children:"Default"}),e.jsx("div",{children:"Actions"})]}),C.map(s=>e.jsxs("div",{className:"dashTable__row",children:[e.jsx("div",{children:s.type==="card"?"Card":"Bank Account"}),e.jsx("div",{children:s.card_brand&&s.card_last4?`${s.card_brand.toUpperCase()} •••• ${s.card_last4}`:"—"}),e.jsx("div",{children:s.card_exp_month&&s.card_exp_year?`${s.card_exp_month}/${s.card_exp_year}`:"—"}),e.jsx("div",{children:s.is_default?e.jsx("span",{className:"dashStatus dashStatus--active",children:"Default"}):"—"}),e.jsx("div",{children:e.jsx("button",{className:"button button--outline",onClick:Y,style:{fontSize:"12px",padding:"4px 8px",height:"auto"},children:"Manage"})})]},s.payment_method_id))]}),e.jsx("div",{className:"dashActions",style:{marginTop:"24px"},children:e.jsx("button",{className:"button button--primary",onClick:Y,children:"Manage Payment Methods"})})]}),o==="history"&&e.jsxs("div",{className:"dashCard",children:[e.jsx("h2",{className:"dashCard__title",children:"Subscription Change History"}),R.length===0?e.jsx("div",{className:"dashMuted",style:{padding:"24px",textAlign:"center"},children:"No changes recorded yet."}):e.jsxs("div",{className:"dashTable",children:[e.jsxs("div",{className:"dashTable__head",children:[e.jsx("div",{children:"Date"}),e.jsx("div",{children:"Change Type"}),e.jsx("div",{children:"From Plan"}),e.jsx("div",{children:"To Plan"}),e.jsx("div",{children:"Prorated Amount"})]}),R.map(s=>e.jsxs("div",{className:"dashTable__row",children:[e.jsx("div",{children:te(s.created_at)}),e.jsx("div",{children:e.jsx("span",{className:`dashStatus dashStatus--${s.change_type==="upgrade"?"active":s.change_type==="downgrade"?"warning":"archived"}`,children:s.change_type.charAt(0).toUpperCase()+s.change_type.slice(1).replace("_"," ")})}),e.jsx("div",{children:s.from_plan?M(s.from_plan):"—"}),e.jsx("div",{children:s.to_plan?M(s.to_plan):"—"}),e.jsx("div",{children:s.prorated_amount?j(s.prorated_amount):"—"})]},s.change_id))]})]})]})}),r&&e.jsx(be,{isOpen:_,onClose:()=>D(!1),currentSubscription:r,onSuccess:()=>{T(),D(!1)}})]})}export{De as default};
